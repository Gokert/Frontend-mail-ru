"use strict";
/**
 * Turns an object literal into a string
 * @param csp CSPObject
 * @returns string
 */
function cspString(csp) {
    const arr = [];
    for (const i in csp) {
        if (csp.hasOwnProperty(i)) {
            arr.push(`${i} ${csp[i].join(" ")}`);
        }
    }
    return arr.join(";");
}
/**
 * Set CSP Headers
 * @param csp CSPObject
 * @param res HttpResponse
 */
function cspHeader(csp, res) {
    res.header('Content-Security-Policy', cspString(csp));
}
module.exports = {
    header: cspHeader
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUlBOzs7O0dBSUc7QUFDSCxTQUFTLFNBQVMsQ0FBQyxHQUFjO0lBQzdCLE1BQU0sR0FBRyxHQUFHLEVBQUUsQ0FBQztJQUVmLEtBQUssTUFBTSxDQUFDLElBQUksR0FBRyxFQUFFO1FBQ2pCLElBQUksR0FBRyxDQUFDLGNBQWMsQ0FBQyxDQUFDLENBQUMsRUFBRTtZQUN2QixHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxDQUFDO1NBQ3hDO0tBQ0o7SUFFRCxPQUFPLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7QUFDekIsQ0FBQztBQU1EOzs7O0dBSUc7QUFDSCxTQUFTLFNBQVMsQ0FBQyxHQUFjLEVBQUUsR0FBaUI7SUFDaEQsR0FBRyxDQUFDLE1BQU0sQ0FBQyx5QkFBeUIsRUFBRSxTQUFTLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztBQUMxRCxDQUFDO0FBR0QsaUJBQVM7SUFDTCxNQUFNLEVBQUUsU0FBUztDQUNwQixDQUFDIn0=